import requests
from bs4 import BeautifulSoup


class PentesterLabScrapper:
	def __init__(self, url: str):
		self.url = url
		self.title = ""
		self.extracted_data = []
		self.solution = ""
		
	def scrape(self):
		response = requests.get(self.url)
		if response.status_code != 200:
			print("Error while geting the response from the URL: " + self.url)
			return None, None, None
		soup = BeautifulSoup(response.text, features="html.parser")

		self.title = soup.find('h1', class_='h1 mb-1 d-inline-block').get_text(strip=True)
		parent_div = soup.find('div', class_='col-12 col-lg-10 col-xl-9 col-xxl-7')
		objective_h3 = soup.find('h3', string=lambda text: text and 'Objective' in text).parent
		
		if parent_div and objective_h3:
			extracted_content = []
			extracted_content.append(objective_h3.get_text(strip=True))
			current_element = objective_h3.find_next_sibling()
			
			while current_element and current_element.parent == parent_div:
				extracted_content.append(current_element.get_text(strip=True))
				current_element = current_element.find_next_sibling()
				
			self.extracted_data.append('\n'.join(extracted_content))
		return self.title, self.extracted_data, self.solution
		
